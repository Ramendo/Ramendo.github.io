(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{"22ff":function(e,t,i){},5288:function(e,t,i){},"5eab":function(e,t,i){"use strict";var s=i("5288"),r=i.n(s);r.a},"61d9":function(e,t,i){"use strict";var s=i("22ff"),r=i.n(s);r.a},ba83:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-page",{directives:[{name:"touch-swipe",rawName:"v-touch-swipe.horizontal",value:e.onPan,expression:"onPan",modifiers:{horizontal:!0}}]},[i("div",{staticStyle:{width:"100%"},style:e.$q.screen.lt.sm?"padding-top: 165px;":"padding-top: 195px;"}),i("parallax-node",{attrs:{x:e.desktopX,y:"0px",weight:1.5,position:e.relPos}},[i("div",{staticClass:"row items-start",style:e.rowStyle+(e.deviceRotated?"display: none;":"")},[i("div",{staticClass:"col-4",staticStyle:{border:"1px solid #ccc"},style:e.resStyle},[[i("input",{ref:"cropImg",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:e.croppie}}),i("q-btn",{staticStyle:{width:"100%","border-radius":"0"},attrs:{flat:"",label:"Загрузить картинку"},on:{click:e.getImgFile}}),i("vue-croppie",{ref:"croppieRef",style:"margin-left: "+(e.rV/2-(e.rV-110)/2)+"px; width: "+(e.rV-110)+"px; height: "+(e.rV-110)+"px;",attrs:{enableResize:!1,enableOrientation:!0,boundary:{},viewport:{width:"",height:"",type:"circle"}},on:{update:e.updateImg}}),e.$q.platform.is.mobile?i("q-btn",{staticStyle:{"border-radius":"0",position:"absolute"},style:"top: "+(e.rV-37)+"px; width: "+e.rV+"px;",attrs:{flat:"",label:"Обновить",icon:"refresh"},on:{click:e.cropImg}}):e._e()]],2),e.itsPhone?i("div",{staticClass:"col-4 text-center",staticStyle:{"font-weight":"bold",border:"1px solid #ccc","font-size":"18px",display:"grid","place-items":"center"},style:e.resStyle},[i("div",{class:e.imgLoaded?"textSmooth":null,style:e.screenLtLg?"padding: 15px; ":"padding: 25px; "},[e.imgLoaded?[i("div",{staticStyle:{"padding-bottom":"25px"}},[e._v("Вы можете заказать наши леденцы, перейдя на страницу оформления заказа:")]),i("q-btn",{staticClass:"bg-orange-9",staticStyle:{color:"white","border-radius":"0px",width:"100%",height:"35px"},attrs:{label:"Перейти"},on:{click:function(t){"/blank"!==e.$router.history.current.path&&e.$router.push("/blank")}}})]:[e._v("В данном конструкторе вы можете посмотреть, как будет выглядеть необходимая картинка на леденце.")]],2)]):i("div",{staticClass:"col-4",staticStyle:{"background-color":"white"},style:e.resStyle,on:{touchstart:function(e){e.stopPropagation()},mousedown:function(e){e.stopPropagation()}}},[i("canvas",{ref:"blankCanvas",style:e.resStyle})]),e.itsPhone?i("div",{staticClass:"col-4",style:e.resStyle},[i("q-img",{style:"position: relative; left: "+47*e.mR+"px; top: "+47*e.mR+"px; width: "+78*e.mR+"px; height: "+78*e.mR+"px; transform-origin: 50% 50%; transform: rotate(-15deg)",attrs:{src:e.replaceImg}}),i("q-img",{style:"position: relative; bottom: "+78*e.mR+"px;",attrs:{src:"constructor/1.png"}})],1):i("div",{staticClass:"col-4 text-center",staticStyle:{"font-weight":"bold",border:"1px solid #ccc","font-size":"18px",display:"grid","place-items":"center"},style:e.resStyle},[i("div",{class:e.imgLoaded?"textSmooth":null,style:e.screenLtLg?"padding: 15px; ":"padding: 25px; "},[e.imgLoaded?[i("div",{staticStyle:{"padding-bottom":"25px"}},[e._v("Вы можете заказать наши леденцы, перейдя на страницу оформления заказа:")]),i("q-btn",{staticClass:"bg-orange-9",staticStyle:{color:"white","border-radius":"0px",width:"100%",height:"35px"},attrs:{label:"Перейти"},on:{click:function(t){"/blank"!==e.$router.history.current.path&&e.$router.push("/blank")}}})]:[e._v("В данном конструкторе вы можете посмотреть, как будет выглядеть необходимая картинка на леденце.")]],2)]),e.itsPhone?i("div",{staticClass:"col-4",staticStyle:{"background-color":"white"},style:e.resStyle,on:{touchstart:function(e){e.stopPropagation()},mousedown:function(e){e.stopPropagation()}}},[i("canvas",{ref:"blankCanvas",style:e.resStyle})]):i("div",{staticClass:"col-4",style:e.resStyle},[i("q-img",{style:"position: relative; left: "+47*e.mR+"px; top: "+47*e.mR+"px; width: "+78*e.mR+"px; height: "+78*e.mR+"px; transform-origin: 50% 50%; transform: rotate(-15deg)",attrs:{src:e.replaceImg}}),i("q-img",{style:"position: relative; bottom: "+78*e.mR+"px;",attrs:{src:"constructor/1.png"}})],1),i("div",{staticClass:"col-4",style:e.resStyle},[i("q-img",{style:"position: relative; left: "+143*e.mR+"px; top: "+179*e.mR+"px; width: "+47*e.mR+"px; height: "+47*e.mR+"px; transform-origin: 50% 50%; transform: rotate(0deg)",attrs:{src:e.replaceImg}}),i("q-img",{style:"position: relative; bottom: "+47*e.mR+"px;",attrs:{src:"constructor/2.png"}})],1),i("div",{staticClass:"col-4",style:e.resStyle},[i("q-img",{style:"position: relative; left: "+86*e.mR+"px; top: "+38*e.mR+"px; width: "+60*e.mR+"px; height: "+60*e.mR+"px; transform-origin: 50% 50%; transform: rotate(-30deg)",attrs:{src:e.replaceImg}}),i("q-img",{style:"position: relative; bottom: "+60*e.mR+"px;",attrs:{src:"constructor/3.png"}})],1)]),this.$q.platform.is.mobile&&this.$q.screen.lt.sm?i("div",{staticStyle:{position:"absolute",width:"100%","pointer-events":"none"},style:e.navArrows},[i("q-btn",{staticClass:"bg-orange-9 text-white",staticStyle:{width:"50px",height:"50px","margin-left":"15px","pointer-events":"auto"},style:0===e.idPos?"display: none;":null,attrs:{icon:"keyboard_arrow_left",round:""},on:{click:function(t){return e.onNArrow(-1)}}}),i("q-btn",{staticClass:"bg-orange-9 text-white",staticStyle:{width:"50px",height:"50px","margin-right":"15px",float:"right","pointer-events":"auto"},style:e.idPos===this.fixedPositions.length-1?"display: none;":null,attrs:{icon:"keyboard_arrow_right",round:""},on:{click:function(t){return e.onNArrow(1)}}})],1):e._e()]),e.deviceRotated?i("div",{staticClass:"text-center",staticStyle:{"font-size":"18px",padding:"15px","font-weight":"bold"}},[e._v("Пожалуйста, переверните устройство!")]):e._e(),i("div",{staticStyle:{width:"100%"},style:e.$q.screen.lt.sm?"padding-top: 82px;":"padding-top: 97px;"}),i("div",{staticClass:"row justify-center"},[i("div",{staticClass:"col text-center",staticStyle:{"font-size":"20px",color:"#756f63",width:"100%","max-width":"1200px","padding-left":"20px","padding-right":"20px"}},[i("div",[e._v("На сайте представлена виртуальная модель леденца.")]),i("div",[e._v("Готовый продукт может незначительно отличаться от виртуальной модели по цвету, тональности и деталям.")])])]),i("div",{staticStyle:{width:"100%"},style:e.$q.screen.lt.sm?"padding-top: 90px;":"padding-top: 180px;"}),i("canvas",{ref:"textureCanvas",staticStyle:{display:"none"}})],1)},r=[],n=i("4082"),a=i.n(n),o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"parallax-node",style:{left:e.x,top:e.y,"z-index":100*e.weight,transform:"translateX("+e.weight*e.relPos+"px)","pointer-events":e.nomouse?"none":null}},[e._t("default",[i("q-img",{staticStyle:{"pointer-events":"none"},style:{width:e.width+"px",height:e.height+"px"},attrs:{src:e.src,width:e.width+"px",height:e.height+"px",position:"0 0"}})],{ratioWidth:e.ratioWidth,ratioHeight:e.ratioHeight})],2)},l=[],c=i("1209"),d={props:{src:String,x:String,y:String,width:Number,height:Number,weight:Number,position:Number,nomouse:Boolean},data(){return{relPos:0,animation:null}},computed:{ratioWidth(){return this.$q.screen.width/1920},ratioHeight(){return this.$q.screen.height/969}},methods:{},watch:{position(e){this.animation&&this.animation.pause(),this.animation=Object(c["a"])({targets:this,relPos:e,easing:"easeInOutQuad",round:1})}}},h=d,p=(i("61d9"),i("2877")),m=i("068f"),g=i("eebe"),u=i.n(g),f=Object(p["a"])(h,o,l,!1,null,"60ba1cb7",null),x=f.exports;u()(f,"components",{QImg:m["a"]});var w=i("5a89"),y=i("34ad"),v=i("4721");function b(){return{defaultWidth:325,defaultHeight:325,maskImage:new Image(1024,1024),animationId:-1,mesh:null,meshImage:null,renderer:null,scene:null,resize:null}}let P=b();function $(e,t,i){const s=i.getContext("2d");s.canvas.width=1024,s.canvas.height=1024,s.fillStyle="#FFF",s.fillRect(0,0,s.canvas.width,s.canvas.height);const r=new w["g"](s.canvas);function n(){s.fillStyle="#f7fffc",s.fillRect(0,0,s.canvas.width,s.canvas.height);let e=this.width/this.height;s.drawImage(P.meshImage,768-256*e,0,512*e,512),s.drawImage(P.maskImage,0,0,1024,1024),r.needsUpdate=!0}P.meshImage=new Image,P.meshImage.onload=n,P.renderer=new w["wb"]({canvas:t,antialias:!0}),e.screenLtLg?P.renderer.setSize(window.innerWidth,window.innerHeight):P.renderer.setSize(P.defaultWidth,P.defaultHeight),P.renderer.autoClearColor=!1;const a=75,o=e.screenLtLg?window.innerWidth/window.innerHeight:P.defaultWidth/P.defaultHeight,l=.1,c=1100,d=new w["V"](a,o,l,c);d.position.x=1;const h=new v["a"](d,P.renderer.domElement);h.minDistance=1,h.maxDistance=3,h.enableKeys=!1,h.enablePan=!1,h.minPolarAngle=Math.PI/16,h.maxPolarAngle=Math.PI-Math.PI/16,h.minAzimuthAngle=Math.PI-Math.PI/3*2,h.maxAzimuthAngle=Math.PI/3*2;let p="/models/construct/",m=[p+"px.jpg",p+"nx.jpg",p+"py.jpg",p+"ny.jpg",p+"pz.jpg",p+"nz.jpg"],g=(new w["l"]).load(m);g.mapping=w["k"],P.scene=new w["fb"],P.scene.background=g,P.resize=function(t){if(t=Math.round(t),e.screenLtLg){let e=t,i=t;d.aspect=e/i,d.updateProjectionMatrix(),P.renderer.setSize(e,i)}else{let e=P.defaultWidth,t=P.defaultHeight;d.aspect=e/t,d.updateProjectionMatrix(),P.renderer.setSize(e,t)}};const u=new w["a"](16777215);P.scene.add(u);let f=new w["j"](1,1e3,256);f.renderTarget.texture.generateMipmaps=!0,f.renderTarget.texture.minFilter=w["C"];let x=new w["M"]({color:16777215,envMap:f.renderTarget.texture,refractionRatio:.985,opacity:.3,transparent:!0});if(P.mesh)P.mesh.children[1].material.map=r,P.scene.add(P.mesh);else{const e=new y["a"];e.load("/models/construct/ledenec.gltf",e=>{P.mesh=e.scene,P.mesh.scale.x=.7,P.mesh.scale.y=.7,P.mesh.scale.z=.7,P.mesh.children[2].material.map=r,P.mesh.children[1].material=x,P.scene.add(P.mesh),P.mesh.position.y=-2.75,P.mesh.rotateY(Math.PI)})}function b(e){h.update(),f.update(P.renderer,P.scene),x.envMap=f.renderTarget.texture,P.renderer.render(P.scene,d),P.animationId=requestAnimationFrame(b)}P.renderer.render(P.scene,d),P.animationId=requestAnimationFrame(b)}function S(){cancelAnimationFrame(P.animationId);while(P.scene.children.length>0){let e=P.scene.children[0];e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose(),P.scene.remove(e)}P.scene.dispose(),P.renderer.renderLists.dispose(),window.removeEventListener("resize",P.resize),P=b()}P.maskImage.src="/models/construct/lpOrder.png";var I={get meshImage(){return P.meshImage},main:$,destroy:S,get resize(){return P.resize}};const q="KOLOKARAMELLO - Конструктор";var R={components:{ParallaxNode:x},data(){return{relPos:0,idPos:0,fixedPositions:[0,1/1.5,2/1.5],croppieImage:"",imgLoaded:!1,replaceImg:"img/logo-circle.png",timer:0,screenHeight:0,fabLeft:!0,fabCenter:!0,fabRight:!0}},computed:{rV(){return this.$q.platform.is.mobile&&this.$q.screen.lt.sm?this.$q.screen.width:325},rowStyle(){return`width: ${3*this.rV}px; height: ${2*this.rV}px; background-color: #eee;`},resStyle(){return`width: ${this.rV}px; height: ${this.rV}px;`},desktopX(){return this.$q.screen.lt.lg&&(this.$q.screen.lt.sm||this.$q.screen.width<975)?`calc(50% - ${this.rV/2}px)`:`calc(50% - ${3*this.rV/2}px)`},screenLtLg(){return this.$q.screen.lt.lg},screenHeightIsSmall(){return this.$q.screen.height<550},deviceRotated(){return this.$q.platform.is.mobile&&this.$q.screen.width>this.$q.screen.height},cpR(){return this.rV},mR(){return this.$q.screen.lt.lg?this.rV/325:1},navArrows(){return`left: ${100*this.idPos}%; bottom: ${this.$q.screen.width-25}px;`},itsPhone(){return this.$q.platform.is.mobile&&this.$q.screen.lt.sm}},meta:{title:q},mounted(){this.screenHeight=this.$q.screen.height,I.main(this,this.$refs.blankCanvas,this.$refs.textureCanvas),I.resize(this.rV),!this.$q.screen.lt.sm&&this.$q.screen.width<975&&(this.idPos=1,this.relPos=-this.fixedPositions[this.idPos]*this.rV)},destroyed(){I.destroy()},methods:{onPan(e){let{event:t}=e,i=a()(e,["event"]);if(this.$q.screen.lt.sm||this.$q.screen.width<975){let e=performance.now();if(e-this.timer>250&&i.distance.x>5){this.timer=e;let t="left"===i.direction?1:-1;this.idPos+t>=0&&this.idPos+t<this.fixedPositions.length&&(this.idPos+=t,this.relPos=-this.fixedPositions[this.idPos]*this.rV)}}},onNArrow(e){this.idPos+e>=0&&this.idPos+e<this.fixedPositions.length&&(this.idPos+=e,this.relPos=-this.fixedPositions[this.idPos]*this.rV)},getImgFile(){this.$refs.cropImg.click()},loadToLollipop(e){let t=this.$refs.imgFileInput;if(t.files&&t.files[0]){let e=new FileReader;e.onload=e=>{I.meshImage.src=e.target.result},e.readAsDataURL(t.files[0])}},croppie(e){var t=e.target.files||e.dataTransfer.files;if(t.length){var i=new FileReader;i.onload=e=>{this.$refs.croppieRef.bind({url:e.target.result}),this.imgLoaded=!0},i.readAsDataURL(t[0])}},updateImg(){this.$q.platform.is.mobile||this.cropImg()},cropImg(){if(!this.imgLoaded)return;let e={type:"base64",size:{width:1024,height:1024},format:"jpeg"};this.$refs.croppieRef.result(e,e=>{this.croppieImage=e,I.meshImage.src=e,this.replaceImg=e})},rotate(e){this.$refs.croppieRef.rotate(e)}},watch:{screenLtLg(e){e||(this.relPos=0)},rV(e){I.resize(e)}}},L=R,k=(i("5eab"),i("9989")),C=i("9c40"),z=i("12c5"),V=Object(p["a"])(L,s,r,!1,null,"7baefdb3",null);t["default"]=V.exports;u()(V,"components",{QPage:k["a"],QBtn:C["a"],QImg:m["a"]}),u()(V,"directives",{TouchSwipe:z["a"]})}}]);